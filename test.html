<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>CORS í…ŒìŠ¤íŠ¸ í´ë¼ì´ì–¸íŠ¸</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    textarea { width: 100%; height: 200px; margin-top: 10px; }
    input[type="text"], input[type="password"] { width: 100%; }
    button { margin-top: 10px; }
  </style>
</head>
<body>

  <h2>1ï¸âƒ£ ë¡œê·¸ì¸ ìš”ì²­</h2>

  <label>ë¡œê·¸ì¸ ìš”ì²­ URL:</label><br>
  <input type="text" id="login-url" value="http://localhost:18080/user/login"><br><br>

  <label>Username:</label><br>
  <input type="text" id="username" value="leeseokwoon"><br><br>

  <label>Password:</label><br>
  <input type="password" id="password" value="password123"><br><br>

  <button id="send-login">ë¡œê·¸ì¸ ìš”ì²­ ë³´ë‚´ê¸°</button>

  <h3>ì‘ë‹µ ê²°ê³¼ (ë¡œê·¸ì¸)</h3>
  <textarea id="login-result" readonly></textarea>

  <hr>

  <h2>2ï¸âƒ£ ë©¤ë²„ ëª©ë¡ ìš”ì²­</h2>

  <label>ë©¤ë²„ API ìš”ì²­ URL:</label><br>
  <input type="text" id="members-url" value="http://localhost:18080/api/members?offset=0&limit=5"><br><br>

  <button id="get-members">ë©¤ë²„ ëª©ë¡ ìš”ì²­ ë³´ë‚´ê¸°</button>

  <h3>ì‘ë‹µ ê²°ê³¼ (ë©¤ë²„ ëª©ë¡)</h3>
  <textarea id="members-result" readonly></textarea>

  <script>
    // ë¡œê·¸ì¸ ìš”ì²­ ì²˜ë¦¬
    document.getElementById("send-login").addEventListener("click", async () => {
      const url = document.getElementById("login-url").value.trim();
      const username = document.getElementById("username").value;
      const password = document.getElementById("password").value;
      const resultArea = document.getElementById("login-result");

      resultArea.value = "ìš”ì²­ ì¤‘...";

      try {
        const response = await fetch(url, {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({ username, password }),
          credentials: "include"
        });

        const headers = Array.from(response.headers.entries())
          .map(([k, v]) => `${k}: ${v}`)
          .join("\n");

        const bodyText = await response.text();

        resultArea.value = `ğŸ“Œ ìƒíƒœ ì½”ë“œ: ${response.status} ${response.statusText}\n\nğŸ“‹ ì‘ë‹µ í—¤ë”:\n${headers}\n\nğŸ“¦ ì‘ë‹µ ë³¸ë¬¸:\n${bodyText}`;
      } catch (err) {
        resultArea.value = `âŒ ìš”ì²­ ì‹¤íŒ¨: ${err}`;
      }
    });

    // ë©¤ë²„ ì¡°íšŒ ìš”ì²­ ì²˜ë¦¬
    document.getElementById("get-members").addEventListener("click", async () => {
      const url = document.getElementById("members-url").value.trim();
      const resultArea = document.getElementById("members-result");

      resultArea.value = "ìš”ì²­ ì¤‘...";

      try {
        const response = await fetch(url, {
          method: "GET",
          credentials: "include"
        });

        const headers = Array.from(response.headers.entries())
          .map(([k, v]) => `${k}: ${v}`)
          .join("\n");

        const bodyText = await response.text();

        resultArea.value = `ğŸ“Œ ìƒíƒœ ì½”ë“œ: ${response.status} ${response.statusText}\n\nğŸ“‹ ì‘ë‹µ í—¤ë”:\n${headers}\n\nğŸ“¦ ì‘ë‹µ ë³¸ë¬¸:\n${bodyText}`;
      } catch (err) {
        resultArea.value = `âŒ ìš”ì²­ ì‹¤íŒ¨: ${err}`;
      }
    });
  </script>

</body>
</html>